<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title> Best Programming Language ï¼Ÿ ğŸ˜ˆ JAVASCRIPT</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Just learn and run">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.d0f45259.js" as="script"><link rel="preload" href="/assets/js/2.9e697bc4.js" as="script"><link rel="preload" href="/assets/js/48.b8a8b538.js" as="script"><link rel="prefetch" href="/assets/js/10.48b8c953.js"><link rel="prefetch" href="/assets/js/11.f612be11.js"><link rel="prefetch" href="/assets/js/12.b835a644.js"><link rel="prefetch" href="/assets/js/13.be4ff992.js"><link rel="prefetch" href="/assets/js/14.bbd05573.js"><link rel="prefetch" href="/assets/js/15.1b4ee2f2.js"><link rel="prefetch" href="/assets/js/16.588a1728.js"><link rel="prefetch" href="/assets/js/17.ae68adab.js"><link rel="prefetch" href="/assets/js/18.68e9d6df.js"><link rel="prefetch" href="/assets/js/19.d2991acb.js"><link rel="prefetch" href="/assets/js/20.8fe6b2cd.js"><link rel="prefetch" href="/assets/js/21.12c5dbb4.js"><link rel="prefetch" href="/assets/js/22.ddd0487c.js"><link rel="prefetch" href="/assets/js/23.4cead595.js"><link rel="prefetch" href="/assets/js/24.0a65f294.js"><link rel="prefetch" href="/assets/js/25.0c8ed6b4.js"><link rel="prefetch" href="/assets/js/26.6591a69e.js"><link rel="prefetch" href="/assets/js/27.ff0fa1ef.js"><link rel="prefetch" href="/assets/js/28.858f8826.js"><link rel="prefetch" href="/assets/js/29.3f6b44e9.js"><link rel="prefetch" href="/assets/js/3.0b8b26d0.js"><link rel="prefetch" href="/assets/js/30.69cef0d1.js"><link rel="prefetch" href="/assets/js/31.576782ee.js"><link rel="prefetch" href="/assets/js/32.78085356.js"><link rel="prefetch" href="/assets/js/33.25cb7d39.js"><link rel="prefetch" href="/assets/js/34.d18511e2.js"><link rel="prefetch" href="/assets/js/35.6dc2bd90.js"><link rel="prefetch" href="/assets/js/36.b695c924.js"><link rel="prefetch" href="/assets/js/37.d803bac1.js"><link rel="prefetch" href="/assets/js/38.8abd0adb.js"><link rel="prefetch" href="/assets/js/39.3b23f090.js"><link rel="prefetch" href="/assets/js/4.e7c996f5.js"><link rel="prefetch" href="/assets/js/40.31a5553f.js"><link rel="prefetch" href="/assets/js/41.96f2dfc6.js"><link rel="prefetch" href="/assets/js/42.da2b78c0.js"><link rel="prefetch" href="/assets/js/43.2b80b114.js"><link rel="prefetch" href="/assets/js/44.03f54269.js"><link rel="prefetch" href="/assets/js/45.182bfe6b.js"><link rel="prefetch" href="/assets/js/46.cede0b20.js"><link rel="prefetch" href="/assets/js/47.869f0654.js"><link rel="prefetch" href="/assets/js/49.d919b506.js"><link rel="prefetch" href="/assets/js/5.6eff8140.js"><link rel="prefetch" href="/assets/js/50.b754644d.js"><link rel="prefetch" href="/assets/js/51.a3cf1047.js"><link rel="prefetch" href="/assets/js/52.4ee6e441.js"><link rel="prefetch" href="/assets/js/6.17d5dd20.js"><link rel="prefetch" href="/assets/js/7.576da1bf.js"><link rel="prefetch" href="/assets/js/8.6fffe5ac.js"><link rel="prefetch" href="/assets/js/9.0041b96e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name"> Best Programming Language ï¼Ÿ ğŸ˜ˆ JAVASCRIPT</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>frontend</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>browser</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>vuejs</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/1.html" class="sidebar-link">new vue()ä¹‹å‰éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼ˆä¸€ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/2.html" class="sidebar-link">new Vue(options) ä¸­çš„optionsåˆå¹¶å¤„ç†ï¼ˆäºŒï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/3.html" class="sidebar-link">åœ¨new Vue(options)ä¸­æ˜¯å¦‚ä½•ä¸ºoptionsè¿›è¡Œåˆå§‹åŒ–ï¼ˆä¸‰ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/4.html" class="sidebar-link">initStateä¸å“åº”å¼åŸç†ï¼ˆå››ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/5.html" class="sidebar-link">ä»$mountåˆ°è™šæ‹Ÿdomï¼ˆäº”ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/diff.html" aria-current="page" class="active sidebar-link">diff æºç  æ³¨é‡Šç‰ˆ</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">updateChildren</span><span class="token punctuation">(</span>
  <span class="token parameter">parentElm<span class="token punctuation">,</span>
  oldCh<span class="token punctuation">,</span>
  newCh<span class="token punctuation">,</span>
  insertedVnodeQueue<span class="token punctuation">,</span>
  removeOnly</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> oldStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> newStartIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oldEndIdx <span class="token operator">=</span> oldCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>oldEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> newEndIdx <span class="token operator">=</span> newCh<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span>newEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oldKeyToIdx<span class="token punctuation">,</span> idxInOld<span class="token punctuation">,</span> vnodeToMove<span class="token punctuation">,</span> refElm<span class="token punctuation">;</span>

  <span class="token comment">// removeOnly is a special flag used only by &lt;transition-group&gt;</span>
  <span class="token comment">// to ensure removed elements stay in correct relative positions</span>
  <span class="token comment">// during leaving transitions</span>
  <span class="token keyword">var</span> canMove <span class="token operator">=</span> <span class="token operator">!</span>removeOnly<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">checkDuplicateKeys</span><span class="token punctuation">(</span>newCh<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
     * 
     * æ•´ä¸ªdiffè¿‡ç¨‹æ˜¯ä¸€ä¸ªä¸æ–­whileå¾ªç¯çš„è¿‡ç¨‹ åœ¨å¾ªç¯è¿‡ç¨‹ä¸­é€šè¿‡ä¸åŒçš„caseè¿›è¡Œåˆ¤æ–­ 
     * é€šè¿‡ä¸åŒæƒ…å†µçš„åˆ¤æ–­é€‰æ‹©å‡ºæœ€ä¼˜çš„èŠ‚ç‚¹ç§»åŠ¨æ–¹å¼
     * æ¯ç»è¿‡ä¸€ä¸ªwhileå¾ªç¯ old/new start idx++ï¼Œç›¸åçš„ old/new end idx --
     * å½“oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdxçš„æƒ…å†µä¸‹ä¼šä¸æ–­çš„è¿›è¡Œwhileå¾ªç¯è¿›è¡Œdiffæ“ä½œèŠ‚ç‚¹ä½ç½®æ“ä½œ
     * åœ¨æ•´ä¸ªdiffè¿‡ç¨‹ä¸­ æ˜¯åŒçº§æ¯”è¾ƒçš„ æ²¡æœ‰è·¨å±‚çº§è¿›è¡Œdiff æ¯”è¾ƒçš„vnodeçš„çˆ¶èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªã€‚
     
          +--&gt;                                       &lt;--+

      old start idx                                old end idx
          +----+         +----+         +----+       +----+
          |    |         |    |         |    |       |    |
          |    |         |    |         |    |       |    |
          +----+         +----+         +----+       +----+


          +----+         +----+         +----+       +----+       +----+
          |    |         |    |         |    |       |    |       |    |
          |    |         |    |         |    |       |    |       |    |
          +----+         +----+         +----+       +----+       +----+
      new start idx                                             new end idx

           +--&gt;                                                    &lt;--+

     */</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&lt;=</span> oldEndIdx <span class="token operator">&amp;&amp;</span> newStartIdx <span class="token operator">&lt;=</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 1 ï¼š æ—§çš„åˆ—è¡¨ä¸­ oldstartvnodeä¸å­˜åœ¨ ç›´æ¥ ++ åç§»ä¸€ä½</span>
      oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Vnode has been moved left</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 2 : æ—§çš„åˆ—è¡¨ä¸­ oldendvnodeä¸å­˜åœ¨ ç›´æ¥ -- å‰ç§»ä¸€ä½</span>
      oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 3 ï¼šåˆ¤æ–­æ–°æ—§start vnodeæ˜¯ä¸æ˜¯ç›¸åŒçš„ å¦‚æœæ˜¯ç›¸åŒçš„ ç›´æ¥å¯¹è¿™ä¸¤ä¸ªç›¸åŒçš„vnodeè¿›è¡Œé™ˆå±‚çš„patchVnodeæ“ä½œ</span>
      <span class="token function">patchVnode</span><span class="token punctuation">(</span>
        oldStartVnode<span class="token punctuation">,</span>
        newStartVnode<span class="token punctuation">,</span>
        insertedVnodeQueue<span class="token punctuation">,</span>
        newCh<span class="token punctuation">,</span>
        newStartIdx
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 4 ï¼š å¦‚æœ æ—§end å’Œ æ–°endç›¸åŒ ï¼Œå¯¹è¿™ä¸¤ä¸ªèŠ‚ç‚¹è¿›è¡Œæ·±åº¦çš„patchVnodeæ“ä½œ</span>
      <span class="token function">patchVnode</span><span class="token punctuation">(</span>
        oldEndVnode<span class="token punctuation">,</span>
        newEndVnode<span class="token punctuation">,</span>
        insertedVnodeQueue<span class="token punctuation">,</span>
        newCh<span class="token punctuation">,</span>
        newEndIdx
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldStartVnode<span class="token punctuation">,</span> newEndVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 5 :å¦‚æœæ—§startå’Œæ–°endæ˜¯ç›¸åŒçš„èŠ‚ç‚¹ ç¬¬ä¸€æ­¥å¯¹è¿™ä¸¤ä¸ªèŠ‚ç‚¹è¿›è¡Œæ·±å±‚çš„patchvnodeï¼Œ æŠŠå­èŠ‚ç‚¹éƒ½patchå®Œæ¯•ï¼Œç¬¬äºŒæ­¥æŠŠæ—§startæ’å…¥åˆ°æ—§endåè¾¹ ä¹Ÿå°±æ˜¯å’Œæ–°vnodeä¿æŒä¸€è‡´</span>
      <span class="token function">patchVnode</span><span class="token punctuation">(</span>
        oldStartVnode<span class="token punctuation">,</span>
        newEndVnode<span class="token punctuation">,</span>
        insertedVnodeQueue<span class="token punctuation">,</span>
        newCh<span class="token punctuation">,</span>
        newEndIdx
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      canMove <span class="token operator">&amp;&amp;</span>
        nodeOps<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>
          parentElm<span class="token punctuation">,</span>
          oldStartVnode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span>
          nodeOps<span class="token punctuation">.</span><span class="token function">nextSibling</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">.</span>elm<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      oldStartVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">++</span>oldStartIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newEndVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">--</span>newEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>oldEndVnode<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 6 ï¼šå¦‚æœæ—§endå’Œæ–°startç›¸åŒ ç¬¬ä¸€æ­¥ï¼šæ·±å±‚patch ç¬¬äºŒæ­¥ï¼šæŠŠæ—§endæ·»åŠ åˆ°æ—§startå‰è¾¹</span>
      <span class="token function">patchVnode</span><span class="token punctuation">(</span>
        oldEndVnode<span class="token punctuation">,</span>
        newStartVnode<span class="token punctuation">,</span>
        insertedVnodeQueue<span class="token punctuation">,</span>
        newCh<span class="token punctuation">,</span>
        newStartIdx
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      canMove <span class="token operator">&amp;&amp;</span>
        nodeOps<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> oldEndVnode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>elm<span class="token punctuation">)</span><span class="token punctuation">;</span>
      oldEndVnode <span class="token operator">=</span> oldCh<span class="token punctuation">[</span><span class="token operator">--</span>oldEndIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
      newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// case 7 ï¼š åœ¨ä¸æ»¡è¶³ä¸Šè¿°æƒ…å†µä¸‹ åˆåˆ†ä¸º2ç§å­æƒ…å†µ</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>oldKeyToIdx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨oldkeytoidxä¸å­˜åœ¨çš„æƒ…å†µä¸‹å»æ„å»ºä¸€ä¸ªå“ˆå¸Œè¡¨</span>
        oldKeyToIdx <span class="token operator">=</span> <span class="token function">createKeyToOldIdx</span><span class="token punctuation">(</span>oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      idxInOld <span class="token operator">=</span> <span class="token function">isDef</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token comment">// åˆ¤æ–­å½“å‰æ–°startçš„keyå­˜ä¸å­˜åœ¨</span>
        <span class="token operator">?</span> oldKeyToIdx<span class="token punctuation">[</span>newStartVnode<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token comment">//  å¦‚æœå­˜åœ¨ å°±å»æ—§å“ˆå¸Œè¡¨ä¸­å¯»æ‰¾</span>
        <span class="token operator">:</span> <span class="token function">findIdxInOld</span><span class="token punctuation">(</span>newStartVnode<span class="token punctuation">,</span> oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦åˆ™é€šè¿‡samenodeå»æŸ¥æ‰¾</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndef</span><span class="token punctuation">(</span>idxInOld<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨é€šè¿‡å¯»æ‰¾è¿‡å æ²¡æœ‰åœ¨æ—§çš„vnodeåˆ—è¡¨ä¸­æŸ¥æ‰¾åˆ°æ–°çš„vnodeèŠ‚ç‚¹ è¿«ä¸å¾—å·² å»åˆ›å»ºdomå…ƒç´ å¹¶æ’å…¥åˆ°åˆ°domæ ‘ä¸­</span>
        <span class="token function">createElm</span><span class="token punctuation">(</span>
          newStartVnode<span class="token punctuation">,</span>
          insertedVnodeQueue<span class="token punctuation">,</span>
          parentElm<span class="token punctuation">,</span>
          oldStartVnode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span>
          <span class="token boolean">false</span><span class="token punctuation">,</span>
          newCh<span class="token punctuation">,</span>
          newStartIdx
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        vnodeToMove <span class="token operator">=</span> oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// æ‹¿åˆ°éœ€è¦ç§»åŠ¨çš„vnodeèŠ‚ç‚¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sameVnode</span><span class="token punctuation">(</span>vnodeToMove<span class="token punctuation">,</span> newStartVnode<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// åˆ¤æ–­æ˜¯ä¸æ˜¯ç›¸åŒçš„vnodeèŠ‚ç‚¹ ï¼ˆä¸å­˜åœ¨åŒä¸ºundefinedçš„æƒ…å†µ å› ä¸ºå·²ç»åœ¨findçš„è¿‡ç¨‹ä¸­å¯¹åŒä¸ºundefinedçš„æƒ…å†µè¿›è¡Œäº†åˆ¤æ–­ è¿™é‡Œé’ˆå¯¹ä¸¤ä¸ªvnodeè™½ç„¶keyç›¸åŒ ä½†å®é™…ä¸Šä¸æ˜¯ä¸¥æ ¼ç›¸åŒçš„vnodeè¿›è¡Œç­›é€‰ï¼‰</span>
          <span class="token function">patchVnode</span><span class="token punctuation">(</span>
            vnodeToMove<span class="token punctuation">,</span>
            newStartVnode<span class="token punctuation">,</span>
            insertedVnodeQueue<span class="token punctuation">,</span>
            newCh<span class="token punctuation">,</span>
            newStartIdx
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
          oldCh<span class="token punctuation">[</span>idxInOld<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
          <span class="token comment">// åœ¨æ¯æ¬¡æ’å…¥çš„è¿‡ç¨‹ä¸­éƒ½æ˜¯åœ¨é€šè¿‡æ—§vnodeçš„å…ƒç´ è¿›è¡Œå®šä½å’Œæ’å…¥ ä»¥ä¿è¯æœ€å°æ”¹åŠ¨ è¿™é‡Œç›´æ¥æŠŠå½“å‰æ‰¾åˆ°çš„vnodeæ’å…¥åˆ°æ—§startï¼ˆå…¶å®ä¸ä¸€å®šæ˜¯start å› ä¸ºidxä¸€ç›´åœ¨å˜ï¼‰å‰è¾¹</span>
          canMove <span class="token operator">&amp;&amp;</span>
            nodeOps<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>parentElm<span class="token punctuation">,</span> vnodeToMove<span class="token punctuation">.</span>elm<span class="token punctuation">,</span> oldStartVnode<span class="token punctuation">.</span>elm<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">//è™½ç„¶é€šè¿‡keyæ‰¾åˆ°äº†æ—§vnode æ•°ç»„ä¸­å¯¹åº”çš„å½“å‰å…ƒç´  ä½†æ˜¯è¿™ä¸¤ä¸ªvnodeå¹¶ä¸æ˜¯ä¸¥æ ¼ç›¸ç­‰çš„ æ‰€ä»¥ç›´æ¥æŒ‰ç…§æœªæ‰¾åˆ°å½“å‰èŠ‚ç‚¹çš„ç­–ç•¥è¿›è¡Œ å»åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ æ— æ³•é€šè¿‡èŠ‚ç‚¹çš„ç§»åŠ¨å»æé«˜æ€§èƒ½</span>
          <span class="token comment">// same key but different element. treat as new element</span>
          <span class="token function">createElm</span><span class="token punctuation">(</span>
            newStartVnode<span class="token punctuation">,</span>
            insertedVnodeQueue<span class="token punctuation">,</span>
            parentElm<span class="token punctuation">,</span>
            oldStartVnode<span class="token punctuation">.</span>elm<span class="token punctuation">,</span>
            <span class="token boolean">false</span><span class="token punctuation">,</span>
            newCh<span class="token punctuation">,</span>
            newStartIdx
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      newStartVnode <span class="token operator">=</span> newCh<span class="token punctuation">[</span><span class="token operator">++</span>newStartIdx<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//å½“å‰æ–°èŠ‚ç‚¹å·²ç»æ’å…¥äº† ++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>oldStartIdx <span class="token operator">&gt;</span> oldEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¿™ä¸ªcaseä¸‹ ä»£è¡¨ æ—§èŠ‚ç‚¹æ¯”æ–°èŠ‚ç‚¹å°‘ å°±éœ€è¦æ·»åŠ æ–°èŠ‚ç‚¹è¿›å»</span>
    refElm <span class="token operator">=</span> <span class="token function">isUndef</span><span class="token punctuation">(</span>newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> newCh<span class="token punctuation">[</span>newEndIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>elm<span class="token punctuation">;</span> <span class="token comment">// ç¡®å®šæ’å…¥ä½ç½®</span>
    <span class="token function">addVnodes</span><span class="token punctuation">(</span>
      parentElm<span class="token punctuation">,</span>
      refElm<span class="token punctuation">,</span>
      newCh<span class="token punctuation">,</span>
      newStartIdx<span class="token punctuation">,</span>
      newEndIdx<span class="token punctuation">,</span>
      insertedVnodeQueue
    <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// éå†æ’å…¥</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>newStartIdx <span class="token operator">&gt;</span> newEndIdx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä»£è¡¨æ–°èŠ‚ç‚¹æ¯”æ—§èŠ‚ç‚¹å°‘ å»åˆ é™¤å°±èŠ‚ç‚¹ä¸­ä¸æƒ³è¦çš„èŠ‚ç‚¹</span>
    <span class="token function">removeVnodes</span><span class="token punctuation">(</span>oldCh<span class="token punctuation">,</span> oldStartIdx<span class="token punctuation">,</span> oldEndIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/frontend/vue_vuex_vue-router_nuxt/vcode/5.html" class="prev">
        ä»$mountåˆ°è™šæ‹Ÿdomï¼ˆäº”ï¼‰
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d0f45259.js" defer></script><script src="/assets/js/2.9e697bc4.js" defer></script><script src="/assets/js/48.b8a8b538.js" defer></script>
  </body>
</html>
