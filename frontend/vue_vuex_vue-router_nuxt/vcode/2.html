<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æˆ‘ä»¬å¯é€šè¿‡ options å»é…ç½® vue çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆ options åˆ°äº† vue å†…éƒ¨åˆ°åº•ä½œä½•å¤„ç†ï¼Ÿ |  learning ğŸ¤”</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="ing">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.8a3e4be4.js" as="script"><link rel="preload" href="/assets/js/2.b1c453a7.js" as="script"><link rel="preload" href="/assets/js/44.e18663a3.js" as="script"><link rel="prefetch" href="/assets/js/10.a1484098.js"><link rel="prefetch" href="/assets/js/11.b70f6910.js"><link rel="prefetch" href="/assets/js/12.aa4e4756.js"><link rel="prefetch" href="/assets/js/13.24822fb7.js"><link rel="prefetch" href="/assets/js/14.ba83d711.js"><link rel="prefetch" href="/assets/js/15.ce56a167.js"><link rel="prefetch" href="/assets/js/16.510d6dca.js"><link rel="prefetch" href="/assets/js/17.41412f1e.js"><link rel="prefetch" href="/assets/js/18.8143a9b6.js"><link rel="prefetch" href="/assets/js/19.dfc55bfb.js"><link rel="prefetch" href="/assets/js/20.d149cd7c.js"><link rel="prefetch" href="/assets/js/21.282166c1.js"><link rel="prefetch" href="/assets/js/22.c878d45b.js"><link rel="prefetch" href="/assets/js/23.7ea9cee2.js"><link rel="prefetch" href="/assets/js/24.0a65f294.js"><link rel="prefetch" href="/assets/js/25.cf952e8f.js"><link rel="prefetch" href="/assets/js/26.fa6a6b52.js"><link rel="prefetch" href="/assets/js/27.986b9955.js"><link rel="prefetch" href="/assets/js/28.cd904e4d.js"><link rel="prefetch" href="/assets/js/29.22c8bd30.js"><link rel="prefetch" href="/assets/js/3.0b8b26d0.js"><link rel="prefetch" href="/assets/js/30.f974ab27.js"><link rel="prefetch" href="/assets/js/31.c099b303.js"><link rel="prefetch" href="/assets/js/32.eb8d6a86.js"><link rel="prefetch" href="/assets/js/33.77cf9e9a.js"><link rel="prefetch" href="/assets/js/34.67e1bc26.js"><link rel="prefetch" href="/assets/js/35.acda1906.js"><link rel="prefetch" href="/assets/js/36.8f514314.js"><link rel="prefetch" href="/assets/js/37.75d78737.js"><link rel="prefetch" href="/assets/js/38.e372ed82.js"><link rel="prefetch" href="/assets/js/39.31d074d8.js"><link rel="prefetch" href="/assets/js/4.e7c996f5.js"><link rel="prefetch" href="/assets/js/40.a0159801.js"><link rel="prefetch" href="/assets/js/41.633bb894.js"><link rel="prefetch" href="/assets/js/42.2ef5b25c.js"><link rel="prefetch" href="/assets/js/43.f3f083c8.js"><link rel="prefetch" href="/assets/js/45.0853c943.js"><link rel="prefetch" href="/assets/js/46.bb71b1df.js"><link rel="prefetch" href="/assets/js/47.806d670b.js"><link rel="prefetch" href="/assets/js/48.9a81b491.js"><link rel="prefetch" href="/assets/js/49.cc728521.js"><link rel="prefetch" href="/assets/js/5.6eff8140.js"><link rel="prefetch" href="/assets/js/50.64a8e83d.js"><link rel="prefetch" href="/assets/js/51.9125457b.js"><link rel="prefetch" href="/assets/js/52.17eb17a0.js"><link rel="prefetch" href="/assets/js/6.17d5dd20.js"><link rel="prefetch" href="/assets/js/7.576da1bf.js"><link rel="prefetch" href="/assets/js/8.6fffe5ac.js"><link rel="prefetch" href="/assets/js/9.6ab3dd2a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name"> learning ğŸ¤”</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>frontend</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>html</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>browser</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>vuejs</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/1.html" class="sidebar-link">new vue()ä¹‹å‰éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼ˆä¸€ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/2.html" aria-current="page" class="active sidebar-link">new Vue(options) ä¸­çš„optionsåˆå¹¶å¤„ç†ï¼ˆäºŒï¼‰</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/3.html" class="sidebar-link">åœ¨new Vue(options)ä¸­æ˜¯å¦‚ä½•ä¸ºoptionsè¿›è¡Œåˆå§‹åŒ–ï¼ˆä¸‰ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/4.html" class="sidebar-link">initStateä¸å“åº”å¼åŸç†ï¼ˆå››ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/5.html" class="sidebar-link">ä»$mountåˆ°è™šæ‹Ÿdomï¼ˆäº”ï¼‰</a></li><li><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/diff.html" class="sidebar-link">diff æºç  æ³¨é‡Šç‰ˆ</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>threejs</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>backend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>basic</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="æˆ‘ä»¬å¯é€šè¿‡-options-å»é…ç½®-vue-çš„åŠŸèƒ½-é‚£ä¹ˆ-options-åˆ°äº†-vue-å†…éƒ¨åˆ°åº•ä½œä½•å¤„ç†"><a href="#æˆ‘ä»¬å¯é€šè¿‡-options-å»é…ç½®-vue-çš„åŠŸèƒ½-é‚£ä¹ˆ-options-åˆ°äº†-vue-å†…éƒ¨åˆ°åº•ä½œä½•å¤„ç†" class="header-anchor">#</a> æˆ‘ä»¬å¯é€šè¿‡ options å»é…ç½® vue çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆ options åˆ°äº† vue å†…éƒ¨åˆ°åº•ä½œä½•å¤„ç†ï¼Ÿ</h3> <blockquote><p>âš ï¸ options åœ¨ vue å†…éƒ¨è¿›è¡Œç›¸å½“å¤æ‚çš„åˆå¹¶å’Œåˆå§‹åŒ–æ“ä½œï¼Œé‡‡ç”¨åŒ–æ•´ä¸ºé›¶çš„æ–¹å¼ï¼Œå°†è¿™ä¸€å¤§å—æ‹†æˆä¸‰éƒ¨åˆ†è®²è§£ï¼Œå°†åœ¨ç¬¬äºŒç« ï¼ˆæœ¬ç« ï¼‰å’Œç¬¬ä¸‰ã€å››ç« è¿›è¡Œåˆ†æï¼Œæœ¬ç« é‡ç‚¹è®²è§£ option çš„åˆå¹¶è¿‡ç¨‹ã€‚</p></blockquote> <blockquote><p>å¼•è¨€ï¼šè¯•æƒ³ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨å¼€å‘é¡¹ç›®è¿‡ç¨‹ä¸­å¾€å¾€ä¼šç”¨åˆ° Vue çš„å…¨å±€ api - mixinï¼Œå¾ˆç¥å¥‡çš„æ˜¯å…¨å±€æ··å…¥çš„å±æ€§æˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªç»„ä»¶ä¸­é€šè¿‡<code>this.propName</code>è¿›è¡Œè®¿é—®ï¼Œå°±åƒè¿™äº›å±æ€§å®šä¹‰åˆ°äº†å­ç»„ä»¶ä¸­ï¼Œé‚£ä¹ˆ vue æ˜¯å¦‚ä½•è¾¾åˆ°è¿™ç§æ•ˆæœ? é€šè¿‡åˆå¹¶ã€‚</p></blockquote> <p><strong><em>ç”¨è¯­å£°æ˜ï¼š</em></strong></p> <ul><li>å ä½èŠ‚ç‚¹ï¼šä¸‹åˆ—ä»£ç ä¸­ cpn å°±æ˜¯ä¸€ä¸ªå ä½èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ¥å—çˆ¶å­é€šè®¯çš„æ•°æ®ã€‚</li> <li>æ¸²æŸ“èŠ‚ç‚¹ï¼šå ä½èŠ‚ç‚¹å°†æ¸²æŸ“å¼çš„æ•°æ®ä¼ é€’ç»™æ¸²æŸ“èŠ‚ç‚¹ï¼Œæ¸²æŸ“èŠ‚ç‚¹å°±æ˜¯å°†è¦æ¸²æŸ“åˆ°çœŸå® dom ä¸­çš„æ ·å­ã€‚</li> <li>prop å±æ€§ï¼šv-bind ç»‘å®šçš„å±æ€§å°†ä¼šè§£ææˆ$props</li> <li>attr å±æ€§ï¼šæ²¡æœ‰è¢« v-bind ç»‘å®šçš„å±æ€§å°†ä¼šè¢«è§£ææˆ$attrs</li> <li>native æ–¹æ³•ï¼šè¢« native ä¿®é¥°çš„æ–¹æ³•</li> <li>emit æ–¹æ³•ï¼šç»„ä»¶ä¸Šæœªæ·»åŠ  native ä¿®é¥°ç¬¦çš„æ–¹æ³•</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cpn</span> <span class="token attr-name">:disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> <span class="token attr-name">abc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>1</span> <span class="token attr-name">attrName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token punctuation">'</span></span> <span class="token attr-name">@click.native</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">'</span>ck<span class="token punctuation">'</span></span> <span class="token attr-name">@touchend</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span><span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
    import cpn from  './component/Cpn'
    export {
        component:{
            cpn
        },
        methods:{
          ck(){
            console.log('click')
          }
        }
    }
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä»ä¼ å…¥ opts åˆ°åˆå¹¶ opts å…±ç»å†ä»¥ä¸‹å‡ æ­¥ï¼š</p> <ol><li>Vue æ„é€ å™¨</li> <li>Vue.prototype._init()</li> <li>mergeOptions()</li> <li>initInternalComponent()</li> <li>resolveConstructorOptions()</li></ol> <h4 id="vue-æ„é€ å™¨"><a href="#vue-æ„é€ å™¨" class="header-anchor">#</a> Vue æ„é€ å™¨</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Vue</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&quot;production&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Vue</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;Vue is a constructor and should be called with the `new` keyword&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">Vue</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  mixins<span class="token operator">:</span><span class="token punctuation">[</span>name<span class="token punctuation">,</span>password<span class="token punctuation">,</span>email<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// name.js</span>
<span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    reutrn <span class="token punctuation">{</span>
      name<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">procssEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">'zzz'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//password.js</span>
<span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    reutrn <span class="token punctuation">{</span>
      password<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">procssEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">'zzz'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//email.js</span>
<span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    reutrn <span class="token punctuation">{</span>
      email<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">procssEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>email<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">'zzz'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Vue çš„æ„é€ å™¨åŠå…¶ç®€å•ï¼Œé¦–å…ˆé€šè¿‡<code>instanceof</code>è¿›è¡ŒåŸå‹é“¾æ£€æŸ¥ï¼Œåˆ¤æ–­å½“å‰æ˜¯ä¸æ˜¯é€šè¿‡ new vue è°ƒç”¨çš„ function Vue ï¼Œå¦‚æœä¸æ˜¯å°±åœ¨å¼€å‘ç¯å¢ƒä¸‹æç¤ºç”¨æˆ·å¿…é¡»è¦ new Vueï¼Œæ£€æŸ¥è¿‡åç›´æ¥æ‰§è¡ŒåŸå‹æ–¹æ³•<code>_init(options)</code></p> <h4 id="init-å¤„ç†-vm-å®ä¾‹"><a href="#init-å¤„ç†-vm-å®ä¾‹" class="header-anchor">#</a> _init() å¤„ç† vm å®ä¾‹</h4> <p>ä¸Šä¸€ç« ä¸­è¯´è¿‡ï¼Œ_init()ä¸å•å•æ˜¯å¤„ç†ç”¨æˆ· new Vueï¼Œä¹Ÿå¤„ç†äº† vue å†…éƒ¨åˆ›å»ºå­ç»„ä»¶çš„è¿‡ç¨‹ï¼Œ
è¿™ä¸ªæ–¹æ³•åŒ…å«äº† opts å¤„ç†çš„å¾ˆå¤šæ­¥éª¤ï¼ŒåŒ…æ‹¬äº†å¤„ç†ä»çˆ¶ç»„ä»¶ä¼ é€’ä¸‹æ¥çš„ props listener ç­‰ç­‰æ•°æ®ï¼Œåˆå¹¶å¤„ç†å…¨å±€èµ„æºæˆ–è€…æ˜¯é€šè¿‡ Vue.mixin æ··å…¥çš„å…¨å±€èµ„æºï¼Œä¸ºæ•°æ®æ³¨å†Œå“åº”å¼ç­‰ç­‰æ“ä½œã€‚æ¥ä¸‹æ¥å¯¹è¿™å‡ ä¸ªæ­¥éª¤è¿›è¡Œä¸€ä¸€åˆ†æã€‚</p> <h4 id="mergeoptions-åˆå¹¶é…ç½®-æ ¸å¿ƒæ–¹æ³•"><a href="#mergeoptions-åˆå¹¶é…ç½®-æ ¸å¿ƒæ–¹æ³•" class="header-anchor">#</a> mergeOptions() åˆå¹¶é…ç½® æ ¸å¿ƒæ–¹æ³•</h4> <blockquote><p>é¦–å…ˆæ˜ç¡® mergeOptions çš„ç›®çš„ï¼šå…¼å®¹å¹¶åŒ…ï¼Œå°† Vue.options ä½œä¸ºæ ¹åˆå¹¶åˆ°æ¯ä¸ªç»„ä»¶æ„é€ å™¨ä¸Šï¼Œå°†å…¨å±€æ··å…¥çš„å±æ€§ä¸ºæ¯ä¸ªå­ç»„ä»¶å¯ç”¨ï¼Œè®²å±€éƒ¨æ··å…¥çš„å±æ€§ä¸ºå½“å‰ç»„ä»¶å¯ç”¨ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child<span class="token punctuation">,</span> vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    child <span class="token operator">=</span> child<span class="token punctuation">.</span>options<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">normalizeProps</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">normalizeInject</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">normalizeDirectives</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœå½“å‰ä¼ å…¥çš„ child äº‹ function ç±»å‹çš„ï¼Œå°±ä»£è¡¨ä¼ å…¥äº†ä¸€ä¸ªæ„é€ å™¨ï¼Œç›´æ¥å»å–å…¶ options å±æ€§ä½œä¸º child</p> <ul><li><code>parent</code> å¾…åˆå¹¶çš„ options,å°†ä¼šåˆå¹¶åˆ°æ–°å¯¹è±¡ä¸Šå»ã€‚</li> <li><code>child</code> å¾…åˆå¹¶çš„ options,å°†ä¼šåˆå¹¶åˆ°æ–°å¯¹è±¡ä¸Šå»ã€‚</li> <li><code>normalize[asssetsName](child)</code> æ ‡å‡†åŒ–èµ„æºåï¼Œä»¥ props ä¸ºä¾‹ï¼Œåœ¨å­ç»„ä»¶å®šä¹‰ props çš„æ—¶å€™ï¼Œå¯ä»¥å®šä¹‰æ•°ç»„ä¹Ÿå¯ä»¥å®šä¹‰å¯¹è±¡ï¼Œè€Œ vue å†…éƒ¨åœ¨ä½¿ç”¨çš„æ—¶å€™æ˜¯é€šè¿‡åŒä¸€ç§å¤„ç†æ–¹å¼åšå¤„ç†çš„ï¼Œæ­£æ˜¯å› ä¸ºæœ‰è¿™ä¸€æ­¥ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨æ›´çµæ´»çš„ api å»å®šä¹‰ propsã€‚vue åœ¨å¾ˆå¤šåœ°æ–¹éƒ½ä½¿ç”¨äº†è¿™ç§æ–¹å¼ï¼Œåƒæ˜¯æ’æ§½ï¼Œç”¨æˆ·æ‰‹å†™çš„ render å‡½æ•°ç­‰ç­‰ï¼Œéƒ½æ˜¯ä¸ºäº†ç”¨æˆ·ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>child<span class="token punctuation">.</span>_base<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>extends<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    parent <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">.</span>extends<span class="token punctuation">,</span> vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>mixins<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> child<span class="token punctuation">.</span>mixins<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parent <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">.</span>mixins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>child._base</code> å…¶å®å°±æ˜¯ Vue æ„é€ å™¨ è¿™ä¸ª_base å±æ€§ä¼šåœ¨ mergeOptions ä¹‹åè¢«æ·»åŠ åˆ° child ä¸Šè¾¹å»ã€‚è¿™é‡Œä¸»è¦æ˜¯ä¸ºäº†æ’é™¤å·²ç» mergeOption ä¹‹åçš„ child ä¸å†å»è¿›è¡Œæ··å…¥å†…å®¹çš„åˆå¹¶äº†ã€‚</li> <li>å½“å­ç»„ä»¶å†…éƒ¨å®šä¹‰äº† minxins çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆæŠŠæ··å…¥çš„å†…å®¹æ·»åŠ åˆ° parent ä¸­å»ï¼Œè¿™ä¹ˆåšçš„ç›®çš„äº‹é™ä½ mixin çš„ä¼˜å…ˆçº§ï¼Œå› ä¸ºå‡è®¾ mixin ä¸­å®šä¹‰äº† dataï¼Œç»„ä»¶æœ¬èº«ä¹Ÿå®šä¹‰äº† dataï¼Œvue å¸Œæœ›åšåˆ°çš„æ˜¯ç»„ä»¶å†…å®šä¹‰çš„ data æ•°æ®ä¼˜å…ˆçº§æ›´é«˜ï¼Œå»è¦†ç›–æ‰ mixin çš„ dataï¼Œæ‰€ä»¥å…ˆè¦æŠŠ mixin çš„æ•°æ®æ·»åŠ åˆ° parent ä¸Šè¾¹å»ã€‚ï¼ˆé€’å½’ï¼‰</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> key<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">mergeField</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasOwn</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">mergeField</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mergeField</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> strat <span class="token operator">=</span> strats<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> defaultStrat<span class="token punctuation">;</span>
    options<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">strat</span><span class="token punctuation">(</span>parent<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> child<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> vm<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> options
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>var options = {}</code>å¯ä»¥çœ‹åˆ°è¿™å£°æ˜äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ options å¹¶è¿”å›å®ƒï¼Œparent å’Œ child ä¸Šè¾¹çš„å±æ€§éƒ½å°†åˆå¹¶åˆ°ä¸Šè¾¹å»ã€‚</li> <li><code>for(key in ...)</code> ç„¶åå¾ªç¯æŠŠ parent å’Œ child ä¸Šè¾¹çš„å±æ€§éƒ½å®Œæˆä¸€æ¬¡åˆå¹¶ï¼Œè¿™é‡Œåšäº†ä¸€å±‚ç­›é€‰ï¼Œå¦‚æœåœ¨ parent ä¸­éå†è¿‡çš„å°±ä¸ä¼šåœ¨ child ä¸­éå†äº†ã€‚</li> <li><code>mergeField(key)</code> å†…éƒ¨å±æ€§å¤§å¤šéƒ½æœ‰è‡ªå·±çš„åˆå¹¶ç­–ç•¥ï¼Œåƒæ˜¯é’©å­å‡½æ•°çš„åˆå¹¶ï¼Œdata çš„åˆå¹¶ï¼Œprops çš„åˆå¹¶ç­‰ç­‰ï¼Œæ²¡æœ‰çš„å°±ä¼šé‡‡ç”¨é»˜è®¤ç­–ç•¥<code>defalutStart</code>ï¼Œå°†æ‰€æœ‰çš„å±æ€§éå†å®Œä¹‹åå°±å®Œæˆäº†æ•´ä¸ª options çš„åˆå¹¶ã€‚</li> <li>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œåœ¨ Vue å®˜æ–¹çš„ api ä¸­æä¾›äº†äº†<code>Vue.config.optionMergeStrategies</code>ï¼Œè¿™ä¸ª api å¯ä»¥æ¥æŒ‡å®šä¸€äº›è‡ªå®šä¹‰å±æ€§æ˜¯å¦‚ä½•åˆå¹¶çš„ï¼Œè¿™ä¸€ç‚¹åœ¨ vuex ä¸­æœ‰åº”ç”¨ï¼ˆå®˜ç½‘æœ‰æç¤ºï¼‰ã€‚</li></ul> <blockquote><p>âš ï¸ æµ…è°ˆåˆå¹¶ç­–ç•¥ æ­¤éƒ¨åˆ†ä¸æ˜¯ä¸»å¹²å†…å®¹ ä¸æ„Ÿå…´è¶£å¯ä»¥è·³è¿‡</p></blockquote> <ul><li><code>strats.data = strats.provide</code>:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//mergeDataOrFn</span>
<span class="token function">mergeData</span><span class="token punctuation">(</span>
  <span class="token keyword">typeof</span> childVal <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function">childVal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> childVal<span class="token punctuation">,</span>
  <span class="token keyword">typeof</span> parentVal <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function">parentVal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> parentVal
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// mergeData-code</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasOwn</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// toå°±ä»£è¡¨childData</span>
  <span class="token function">set</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> key<span class="token punctuation">,</span> fromVal<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fromValå°±ä»£è¡¨parentDataä¸­çš„æŸä¸ªå±æ€§å€¼</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>
  toVal <span class="token operator">!==</span> fromVal <span class="token operator">&amp;&amp;</span>
  <span class="token function">isPlainObject</span><span class="token punctuation">(</span>toVal<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token comment">// toValå°±ä»£è¡¨childDataä¸­çš„æŸä¸ªå±æ€§å€¼</span>
  <span class="token function">isPlainObject</span><span class="token punctuation">(</span>fromVal<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">mergeData</span><span class="token punctuation">(</span>toVal<span class="token punctuation">,</span> fromVal<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœä¸¤ä¸ªå€¼éƒ½æ˜¯å¯¹è±¡ å°±è¿›è¡Œæ·±å±‚çš„åˆå¹¶</span>
<span class="token punctuation">}</span>
</code></pre></div><p>data å¯èƒ½ä¼ å…¥æ–¹æ³•æˆ–è€…å¯¹è±¡ï¼Œå¦‚æœæ˜¯æ–¹æ³•å°±å¾—åˆ°æ–¹æ³•è¿”å›çš„çš„å¯¹è±¡åè¿›è¡Œ mergeData æ“ä½œã€‚mergeData æ“ä½œæ˜¯é¦–å…ˆåˆ¤æ–­å­ data ä¸Šè¾¹æœ‰æ²¡æœ‰è¯¥å±æ€§ï¼Œå¦‚æœæ²¡æœ‰å°±ç›´æ¥è®¾ç½®å½“å‰å±æ€§åˆ°å­ data ä¸Šå»ï¼Œå¦‚æœå­ä¸Šè¾¹å·²æœ‰å½“å‰å±æ€§å°±åˆ¤æ–­å½“å‰å±æ€§æ˜¯ä¸æ˜¯å¯¹è±¡ç±»å‹çš„ï¼Œå¦‚æœæ˜¯å¯¹è±¡ç±»å‹çš„å°±è¿›è¡Œæ·±å±‚é€’å½’åˆå¹¶ã€‚(provide å’Œ data åˆå¹¶ç­–ç•¥ä¸€è‡´ï¼Œåªä¸è¿‡å°‘äº†ä¸€æ­¥ function ç±»å‹çš„æ ¡éªŒ)</p> <ul><li><code>strats.props = strats.methods = strats.inject = strats.computed</code>ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">extend</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> parentVal<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç®€å•çš„åˆå¹¶ è®²parentValä¸Šè¾¹çš„å±æ€§æ·»åŠ åˆ°ret</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">extend</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> childVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// åŒåå±æ€§è¦†ç›–</span>
</code></pre></div><p>åŒåå±æ€§ child è¦†ç›– parentã€‚</p> <ul><li><code>strats.watch</code>ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parentVal <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parentVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> childVal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">extend</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> parentVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key$<span class="token number">1</span> <span class="token keyword">in</span> childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> parent <span class="token operator">=</span> ret<span class="token punctuation">[</span>key$<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> child <span class="token operator">=</span> childVal<span class="token punctuation">[</span>key$<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºæ•°ç»„</span>
    parent <span class="token operator">=</span> <span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  ret<span class="token punctuation">[</span>key$<span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> parent
    <span class="token operator">?</span> parent<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token comment">// child-wathceræ·»åŠ åˆ°childåè¾¹</span>
    <span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token operator">?</span> child
    <span class="token operator">:</span> <span class="token punctuation">[</span>child<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœæ²¡æœ‰ child-watcher å°±é€šè¿‡åŸå‹é“¾å»ç»§æ‰¿ parent-wathcer å¹¶è¿”å›ç»§æ‰¿åçš„ç©ºå¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰ parent-watcher å°±ç›´æ¥è¿”å› child-watcherã€‚å¦‚æœä¸¤ä¸ªéƒ½æœ‰ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡å°† parent-watcher æ·»åŠ å…¶ä¸­ï¼Œæ¥ä¸‹æ¥éå† child-watcherï¼ŒæŠŠåŒå wathcer éƒ½æ·»åŠ åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ parent-wathcer åœ¨å‰ï¼Œchild-wathcer åœ¨åã€‚åœ¨æ·»åŠ  child-wathcer åˆ°æœ€ç»ˆæ•°ç»„ ret çš„æ—¶å€™è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œä½¿ç”¨çš„<code>[].concat</code>æ–¹æ³•è€Œä¸æ˜¯<code>[].push</code>ï¼Œå› ä¸ºåœ¨å®šä¹‰ watcher çš„æ—¶å€™å¯ä»¥ä¼ å¦‚ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢åŒ…è£¹ç€å±æ€§å˜åŒ–åéœ€è¦è§¦å‘çš„æ–¹æ³•åˆ—è¡¨ï¼Œå¦‚æœ push è¿˜éœ€è¦æ·±åº¦éå†ï¼Œè¿™æ ·åšçš„è¯å°±æ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ã€‚</p> <ul><li><code>strats[hook]</code>:ç”Ÿå‘½å‘¨æœŸé’©å­,</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> res <span class="token operator">=</span> childVal
  <span class="token operator">?</span> parentVal
    <span class="token operator">?</span> parentVal<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>childVal<span class="token punctuation">)</span>
    <span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>childVal<span class="token punctuation">)</span>
    <span class="token operator">?</span> childVal
    <span class="token operator">:</span> <span class="token punctuation">[</span>childVal<span class="token punctuation">]</span>
  <span class="token operator">:</span> parentVal<span class="token punctuation">;</span>
<span class="token keyword">return</span> res
  <span class="token operator">?</span> <span class="token function">dedupeHooks</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// è¿›è¡Œæ–¹æ³•å»é‡</span>
  <span class="token operator">:</span> res<span class="token punctuation">;</span>
</code></pre></div><p>é¦–å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰ childï¼Œæ²¡æœ‰ç›´æ¥å– parentã€‚å¦‚æœå­˜åœ¨ child é’©å­ï¼Œå°±é€šè¿‡ concat è¿›è¡Œåˆå¹¶ï¼Œparent åœ¨å‰ï¼Œchild åœ¨åï¼Œå¦‚æœæ²¡æœ‰ parent å°±ç›´æ¥ç”¨æ•°ç»„åŒ…è£¹ childã€‚æœ€ç»ˆé€šè¿‡ dedupeHooks è¿›è¡ŒåŒåé’©å­å»é‡å°±æ˜¯å½“å‰é’©å­çš„ç»“æœã€‚</p> <ul><li><code>strats.components = strats.filters = strats.directives</code> ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> res <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parentVal <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">extend</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> childVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç»„ä»¶ï¼ŒæŒ‡ä»¤ï¼Œè¿‡æ»¤å™¨éƒ½ç®—æ˜¯é™æ€èµ„æºï¼Œä»–ä»¬é‡‡å–åŒæ ·çš„åˆå¹¶ç­–ç•¥ã€‚é¦–å…ˆé€šè¿‡åŸå‹é“¾ç»§æ‰¿å»åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡è®² parent ä¸­çš„èµ„æºç»§æ‰¿è¿‡æ¥ï¼Œæ¥ä¸‹æ¥å¼€å§‹ child çš„éå†ï¼Œç®€å•å§ child ä¸­çš„å±æ€§å¤åˆ¶åˆ°è¿™ä¸ªç©ºå¯¹è±¡ä¸Šï¼Œæœ€ç»ˆè¿”å›è¿™ä¸ªå¯¹è±¡</p> <ul><li><code>å…¶ä»–å±æ€§</code>ï¼š</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">defaultStrat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">parentVal<span class="token punctuation">,</span> childVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> childVal <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> parentVal <span class="token operator">:</span> childVal<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>é»˜è®¤ç­–ç•¥ï¼Œå¦‚æœ child ä¼ äº†å– child ä¸¢å¼ƒ parentï¼Œå¦åˆ™å– parentã€‚</p> <h4 id="vue-extend-å’Œ-vue-mixin-å¯¹å…¨å±€-options-çš„æ“ä½œ"><a href="#vue-extend-å’Œ-vue-mixin-å¯¹å…¨å±€-options-çš„æ“ä½œ" class="header-anchor">#</a> Vue.extend å’Œ Vue.mixin å¯¹å…¨å±€ options çš„æ“ä½œ</h4> <p>ä¸Šæ–‡æåˆ°ï¼Œåœ¨å¤„ç†ç”¨æˆ·ä¼ å…¥çš„ options çš„æ—¶å€™è¦ä¸ç»„ä»¶æ„é€ å™¨çš„ option è¿›è¡Œä¸€æ¬¡åˆå¹¶ã€‚é‚£ä¹ˆç»„ä»¶æ„é€ å™¨çš„ option æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿè¿™é‡Œæå‰äº†è§£ä¸€ç‚¹ï¼ˆåç»­åˆ›å»ºç»„ä»¶ vnode çš„è¿‡ç¨‹ä¸­ä¼šè¯¦ç»†è§£é‡Šæ•´ä¸ªæµç¨‹ï¼‰ï¼Œvue å†…éƒ¨åœ¨åˆ›å»ºå­ç»„ä»¶ vm å®ä¾‹çš„æ—¶å€™å¿…å…ˆè¦é€šè¿‡ extend å»åˆ›å»ºå­ç»„ä»¶æ„é€ å™¨ï¼Œè¿™å°±éœ€è¦å»çœ‹ Vue.extend çš„æ–¹æ³•å®ç°ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function-variable function">extend</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">extendOptions</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¿™é‡Œçš„optionså°±æ˜¯export defalutçš„options</span>
  extendOptions <span class="token operator">=</span> extendOptions <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> Super <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> <span class="token function-variable function">Sub</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Super</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡åŸå‹é“¾ç»§æ‰¿Super å°±å¯ä»¥è®¿é—®åˆ°Vueçš„åŸå‹æ–¹æ³•äº† $emit $onä¹‹ç±»çš„</span>
  <span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Sub<span class="token punctuation">;</span>

  Sub<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>
    <span class="token comment">// âš ï¸ å°±æ˜¯è¿™é‡Œå°†å…¨å±€æˆ–è€…çˆ¶optionså’Œç”¨æˆ·ä¼ å…¥çš„optionsè¿›è¡Œåˆå¹¶æ“ä½œçš„</span>
    Super<span class="token punctuation">.</span>options<span class="token punctuation">,</span>
    extendOptions
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  Sub<span class="token punctuation">[</span><span class="token string">&quot;super&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> Super<span class="token punctuation">;</span> <span class="token comment">// æŒæœ‰çˆ¶æ„é€ å™¨çš„å¼•ç”¨</span>

  Sub<span class="token punctuation">.</span>extend <span class="token operator">=</span> Super<span class="token punctuation">.</span>extend<span class="token punctuation">;</span> <span class="token comment">// å­æ„é€ å™¨ä¹Ÿå¯ä»¥ç»§ç»­åˆ›å»ºå­å­æ„é€ å™¨</span>
  Sub<span class="token punctuation">.</span>mixin <span class="token operator">=</span> Super<span class="token punctuation">.</span>mixin<span class="token punctuation">;</span>
  Sub<span class="token punctuation">.</span>use <span class="token operator">=</span> Super<span class="token punctuation">.</span>use<span class="token punctuation">;</span>

  <span class="token constant">ASSET_TYPES</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç›´æ¥å§é™æ€èµ„æºæ‹·è´è¿‡æ¥</span>
    Sub<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> Super<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Sub<span class="token punctuation">.</span>superOptions <span class="token operator">=</span> Super<span class="token punctuation">.</span>options<span class="token punctuation">;</span> <span class="token comment">// è®°å½•æœ¬æ¬¡æ„é€ æ—¶çˆ¶æ„é€ å™¨ä¼ å…¥çš„options åç»­åœ¨è¿›è¡Œoptionæ›´æ–°ä¼šæœ‰ç”¨å¤„ resolveConstructorOptionsæ–¹æ³•ä¸­</span>
  Sub<span class="token punctuation">.</span>extendOptions <span class="token operator">=</span> extendOptions<span class="token punctuation">;</span> <span class="token comment">// è®°å½•æœ¬æ¬¡æ„é€ æ—¶ç”¨æˆ·ä¼ å…¥çš„options</span>
  Sub<span class="token punctuation">.</span>sealedOptions <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> Sub<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> Sub<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>æ•´ä¸ª Vue.extend è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æ­¥éª¤å°±æ˜¯ mergeOptionsï¼Œä½¿å¾—å­æ„é€ å™¨æŒæœ‰äº†å…¨å±€/çˆ¶çº§çš„ options ä¹ŸæŒæœ‰äº†ç”¨æˆ·ä¼ å…¥çš„ optionsã€‚</li> <li>å¦å¤–æ³¨æ„ä¸€ç‚¹ï¼Œä¸ºä»€ä¹ˆè¯´å­æ„é€ å™¨æŒæœ‰äº†å…¨å±€**<em>æˆ–è€…çˆ¶çº§</em>**å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€å¥ä»£ç <code>Sub.extend = Super.extend</code>ï¼Œå¾ˆæ˜æ˜¾å­æ„é€ å™¨æŠŠ Vue.extend å¤åˆ¶æ¥äº†ï¼Œæ‰€ä»¥å­æ„é€ å™¨ Sub ä¹Ÿå¯ä»¥é€šè¿‡ extend æ–¹æ³•åŒºåˆ›å»ºå±äºè‡ªå·±çš„å­æ„é€ å™¨äº†ï¼Œä¹Ÿå°±æ˜¯å­™å­æ„é€ å™¨ï¼Œè¿™æ ·ä¸€æ¥å°±åˆåˆå¹¶äº†ä¸€æ¬¡ optionsï¼Œæ‰€ä»¥å­™å­æ„é€ å™¨çš„ Super å¾ˆæ˜æ˜¾ä¸æ˜¯ Vueï¼Œè€Œæ˜¯ Subï¼Œå°±è¿™æ ·å­å­å­™å­™æ— ç©·æ— å°½... è¿™ä¸€ç‚¹åœ¨æ›´æ–°å…¨å±€ options è¦æ ¼å¤–æ³¨æ„ï¼Œæ˜¯ä¸€ä¸ªæ·±åº¦éå†å’Œå›æº¯çš„è¿‡ç¨‹ï¼ˆåœ¨ resoloveConstructorOptions è¿‡ç¨‹ä¸­ï¼‰ã€‚å½“ç„¶åœ¨å¸¸è§„å¼€å‘ä¸­ï¼Œå¤§å®¶å¾ˆå°‘ç”¨å­æ„é€ å™¨å†å»æä¸€äº›æ–°çš„å­™å­å‡ºæ¥ï¼Œvue æä¾›è¿™ç§å¼ºå¤§çš„åŠŸèƒ½ä¾›ä¸€äº› ui åº“å»ä½¿ç”¨ã€‚</li></ul> <p>åœ¨è°ˆè®ºå®Œ Vue.extend å°±å¯ä»¥çœ‹çœ‹ Vue.mixin äº†ï¼Œå®ƒå¾ˆç®€å•å’Œçº¯ç²¹ã€‚çœ‹å¦‚ä¸‹ä»£ç </p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function-variable function">mixin</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mixin</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> mixin<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>çŸ­çŸ­ä¸¤è¡Œä»£ç ï¼Œå°±é€šè¿‡ mergeOptions å®Œæˆäº† mixin æ“ä½œï¼Œä¸è¿‡è¦ç‰¹åˆ«æ³¨æ„ï¼Œmixin æŠŠ this.optionsï¼ˆä¹Ÿå°±æ˜¯å…¨å±€ optionsï¼‰å’Œç”¨æˆ·ä¼ å…¥éœ€è¦æ··å…¥çš„ options è¿›è¡Œäº†ä¸€æ¬¡åˆå¹¶ï¼Œè¿™æ ·ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆå…¨å±€æ··å…¥çš„å±æ€§å¯ä»¥åœ¨æ¯ä¸ªå­ç»„ä»¶ä¸­å¯ä»¥è°ƒç”¨åˆ°äº†ã€‚</p> <ul><li>è¯´åˆ°è¿™é‡Œï¼Œç®€å•æ¢³ç†ä¸€ä¸‹æ•´ä¸ª options é“¾æ¡å…³ç³»ã€‚
<ol><li>é¦–å…ˆ Vue.mixin æ”¹å˜äº†å…¨å±€çš„ optionsã€‚</li> <li>å…¨å±€ options å’Œç»„ä»¶å†…éƒ¨ export çš„ options åˆå¹¶åˆ°å­ç»„ä»¶æ„é€ å™¨çš„ options ä¸Šã€‚</li> <li>å­ç»„ä»¶æ„é€ å™¨çš„ options é€šè¿‡åŸå‹é“¾æŒ‚åˆ° vm.$optionsã€‚
è‡³æ­¤ï¼Œä¾¿å¯ä»¥åœ¨å¼€å‘æ—¶å€™é€šè¿‡this.$options è®¿é—®åˆ° mixinï¼Œå…¨å±€ï¼Œå’Œç»„ä»¶ç‰¹æœ‰çš„ options äº†ã€‚ï¼ˆå½“ç„¶å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸ä¼šé€šè¿‡$options çš„æ–¹å¼å»è®¿é—®å±æ€§ï¼Œç›´æ¥ this è°ƒç”¨å¯ä»¥è·å–åˆ°æ•°æ®çš„åŸå› æ˜¯ vue å†…éƒ¨ä¸ºæˆ‘ä»¬åšäº†ä¸€å±‚ä»£ç†å¹¶æ³¨å†Œäº†å“åº”å¼ã€‚ï¼‰</li></ol></li></ul> <h4 id="initinternalcomponent-åˆå§‹åŒ–å­ç»„ä»¶-options"><a href="#initinternalcomponent-åˆå§‹åŒ–å­ç»„ä»¶-options" class="header-anchor">#</a> initInternalComponent åˆå§‹åŒ–å­ç»„ä»¶ options</h4> <blockquote><p>âš ï¸ è¿™é‡Œç›´æ¥å°† initInternalComponent ä¸­çš„å†…å®¹å±•å¼€ï¼Œåœ¨åç»­çˆ¶å­ç»„ä»¶åˆ›å»ºè¿‡ç¨‹çš„ç« èŠ‚ä¸­è¿˜ä¼šæ¶‰åŠåˆ°ï¼Œåˆ°æ—¶å€™å¯ä»¥å†ç¿»åˆ°è¿™é‡Œæ¥çœ‹ã€‚å¯¹äºåˆæ¬¡ new Vue è¿™é‡Œçš„ä»£ç æ˜¯æ‰§è¡Œä¸åˆ°çš„ï¼Œå¯ä»¥å…ˆç®€å•äº†è§£ä¸€ä¸‹å¯¹äºå­ç»„ä»¶çš„å¤„ç†ï¼Œå¯¹æ¯”å’Œåˆæ¬¡ new Vue çš„åŒºåˆ«ï¼Œå¸¦ç€é—®é¢˜åå¤é˜…è¯»æºç å°è±¡ä¼šæ›´æ›´åŠ æ·±åˆ»ï¼Œå¯¹äºç†è§£å›°éš¾çš„é“å‹å¯ä»¥å…ˆè·³è¿‡ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>_isComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">initInternalComponent</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æŸ¥çœ‹å¦‚ä¸Šä»£ç ä¸­çš„åˆ¤æ–­æ¡ä»¶ <code>options._isComponent</code>ï¼Œè¿™ä¸ªå˜é‡æ˜¯å ä½èŠ‚ç‚¹åˆ›å»º vm å®ä¾‹æ—¶è¿›è¡Œèµ‹å€¼çš„ï¼Œæ‹¥æœ‰è¿™ä¸ªå˜é‡çš„ options å°±ä»£è¡¨æ˜¯ç»„ä»¶çš„ optionsï¼Œ æ˜¯åŒºåˆ†å½“å‰æ˜¯ç”¨æˆ·ä¸»åŠ¨ new Vue è¿˜æ˜¯ Vue å†…éƒ¨åˆ›å»ºç»„ä»¶å®ä¾‹çš„æ ‡å¿—ï¼Œå¯¹äºå†…éƒ¨åˆ›å»ºç»„ä»¶ï¼Œä¼šæ‰§è¡Œå†…éƒ¨ä»£ç ã€‚æœ€ç»ˆå¾—åˆ°å­ç»„ä»¶çš„ optionsã€‚æ¥ä¸‹æ¥è¯¦ç»†è§£æè¿™ä¸ªæ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initInternalComponent</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> opts <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é¦–å…ˆä¸ºå½“å‰è‡ªç»„ä»¶çš„ vm é€šè¿‡åŸå‹é“¾å»åˆ›å»ºä¸€ä¸ª<code>$options</code>ï¼Œè¿™ä¸ª<code>$options.__proto__</code>æŒ‡å‘çš„æ˜¯<strong>å­ç»„ä»¶æ„é€ å™¨</strong>çš„ optionsã€‚</p> <ul><li>å¯¹äºå­ç»„ä»¶æ„é€ å™¨çš„ optionsï¼ˆ<code>vm.constructor.options</code>ï¼‰ï¼Œç”±ä¸¤éƒ¨åˆ†<code>mergeOptions</code>è€Œæ¥ï¼ˆè¿™ä¸ªåˆå¹¶å…·ä½“è¿‡ç¨‹åœ¨ä¸Šå˜å·²ç»è¯¦ç»†åˆ†æè¿‡äº†ï¼‰.
<ul><li>ä¸€æ˜¯<code>Vue.options</code>è¿™æ˜¯æ¯ä¸ª vm å®ä¾‹éƒ½å¯ä»¥è®¿é—®åˆ°çš„ optionsï¼Œä¹Ÿå°±æ˜¯å…¨å±€ options</li> <li>äºŒæ˜¯å­ç»„ä»¶<code>export default</code>å¯¼å‡ºçš„è¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯å­ç»„ä»¶ç‰¹æœ‰çš„ optionsï¼Œï¼ˆè¿™ä¸ªå¯¹è±¡å·²ç»è¢«<code>vue-loader</code>è½¬åŒ–æˆäº†ä¸€ä¸ªæ ‡å‡†çš„ options å¯¹è±¡ï¼Œ<code>vue-loader</code>å°†æ¨¡ç‰ˆéƒ¨åˆ†è½¬åŒ–æˆ render å‡½æ•°å¯¼å‡ºç»™çˆ¶ç»„ä»¶ åç»­ä¼šè®²åˆ°ï¼‰ã€‚</li></ul></li> <li>ç„¶åè¿™ä¸ªåˆå¹¶åçš„ options å°±å¯ä»¥è¢«å­ç»„ä»¶çš„<code>vm.$options</code>è®¿é—®åˆ°ï¼Œåˆå› ä¸ºåˆå¹¶çš„ options æ˜¯<code>Vue.options</code>å’Œå­ç»„ä»¶çš„<code>options</code>åˆå¹¶æ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡<code>$options.__proto__[å±æ€§å]</code>çš„æ–¹å¼è®¿é—®åˆ°å…¨å±€<code>Vue.options</code>å’Œå­ç»„ä»¶<code>export</code>å‡ºæ¥çš„ options`ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> parentVnode <span class="token operator">=</span> options<span class="token punctuation">.</span>_parentVnode<span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>parent <span class="token operator">=</span> options<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>_parentVnode <span class="token operator">=</span> parentVnode<span class="token punctuation">;</span>
</code></pre></div><p>è¿™é‡Œçš„ options æ˜¯ä½œä¸ºå‚æ•°ä¼ å…¥çš„ï¼Œè¿™ä¸ª options é‡Œé¢çš„å†…å®¹æ˜¯å ä½èŠ‚ç‚¹ä¼ é€’è¿‡æ¥çš„ã€‚</p> <ul><li><code>_parentVnode</code>:æ˜¯å­ç»„ä»¶åœ¨çˆ¶ç»„ä»¶ä¸­çš„å ä½èŠ‚ç‚¹ã€‚</li> <li><code>parent</code>:æ˜¯çˆ¶ç»„ä»¶çš„ vm å®ä¾‹
æŠŠè¿™ä¸¤é¡¹æ·»åŠ åˆ° opts ä¸Šè¾¹å»ï¼Œä¾›å­ç»„ä»¶å»è®¿é—®ã€‚</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> vnodeComponentOptions <span class="token operator">=</span> parentVnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>propsData <span class="token operator">=</span> vnodeComponentOptions<span class="token punctuation">.</span>propsData<span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>_parentListeners <span class="token operator">=</span> vnodeComponentOptions<span class="token punctuation">.</span>listeners<span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>_renderChildren <span class="token operator">=</span> vnodeComponentOptions<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
opts<span class="token punctuation">.</span>_componentTag <span class="token operator">=</span> vnodeComponentOptions<span class="token punctuation">.</span>tag<span class="token punctuation">;</span>
</code></pre></div><ul><li><code>componentOptions</code>: æ‰¿è½½äº†çˆ¶å­é€šè®¯ç›¸å…³çš„<code>$props,$attrs,$listener</code>ç­‰ç­‰ä¿¡æ¯ã€‚</li> <li><code>propsData</code>:ä»å ä½èŠ‚ç‚¹ä¸Šè·å–åˆ°çš„ props ç»‘å®šå€¼</li> <li><code>listeners</code>:ä»å ä½èŠ‚ç‚¹ä¸Šè·å–åˆ°çš„ç›‘å¬çš„<strong>é native</strong>æ–¹æ³•</li> <li><code>children</code>:éœ€è¦æ¸²æŸ“çš„å­ vnode æ•°ç»„</li> <li><code>tag</code>:æ ‡ç­¾å</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    opts<span class="token punctuation">.</span>render <span class="token operator">=</span> options<span class="token punctuation">.</span>render<span class="token punctuation">;</span>
    opts<span class="token punctuation">.</span>staticRenderFns <span class="token operator">=</span> options<span class="token punctuation">.</span>staticRenderFns<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>åˆ¤æ–­è°ƒç”¨æ—¶çš„ options æœ‰æ²¡æœ‰ä¼ å…¥ render æ–¹æ³•ï¼Œå¦‚æœæœ‰ï¼Œå°±ä½¿ç”¨ä¼ å…¥çš„ render æ–¹æ³•è¿›è¡Œèµ‹å€¼ã€‚</li></ul> <blockquote><p>ç®€å•æ€»ç»“ä¸€ä¸‹<code>initInternalComponent</code></p> <ul><li>æœ‰ä¸‰ä¸ª options</li></ul></blockquote> <div class="language- extra-class"><pre><code>ä¸€æ˜¯å…¨å±€options ï¼Œ
äºŒæ˜¯export-options ï¼Œ
ä¸‰æ˜¯å­ç»„ä»¶åœ¨åˆ›å»ºvmå®ä¾‹çš„æ—¶å€™å ä½èŠ‚ç‚¹ä¼ å…¥çš„options ã€‚
</code></pre></div><blockquote><ul><li>åœ¨åˆ›å»ºå­ç»„ä»¶ vm å®ä¾‹çš„æ—¶å€™éœ€è¦ç”¨åˆ°ä¸Šè¿°æ‰€æœ‰ä¿¡æ¯ã€‚è¿™ä¸€æ­¥ç›¸å½“äºä¸€ç§æ ‡å‡†åŒ–ï¼Œä¸ºåç»­å†…å®¹ä½œå‡†å¤‡ã€‚</li></ul></blockquote> <h4 id="resolveconstructoroptions-è·å–æ„é€ å™¨ä¸Šçš„-options"><a href="#resolveconstructoroptions-è·å–æ„é€ å™¨ä¸Šçš„-options" class="header-anchor">#</a> resolveConstructorOptions è·å–æ„é€ å™¨ä¸Šçš„ options</h4> <blockquote><p>âš ï¸ æœ¬æ–¹æ³•ä¹Ÿæ˜¯åˆ†ä¸º vue å†…éƒ¨è°ƒç”¨å­ç»„ä»¶_init å’Œç”¨æˆ·ä½¿ç”¨ new Vue(opts)ä¸¤ç§æƒ…å†µï¼Œå¯¹äºåˆæ¬¡ new Vue() å°±ä¼šåˆ¤æ–­ç›´æ¥è·³è¿‡ã€‚</p></blockquote> <blockquote><p>è¿™ä¸ªæ–¹æ³•æ˜¯ä¸ºäº†æ£€æµ‹ç”¨æˆ·åœ¨ vue ä»£ç è¿è¡ŒæœŸé—´æœ‰æ²¡æœ‰æ”¹å˜ Vue.options ä¸Šè¾¹çš„å…¨å±€ options,æ¯”å¦‚ä¸‹è¾¹è¿™ç§éªšæ“ä½œ,å®šä¹‰ä¸€ä¸ªç‚¹å‡»å°±å…¨å±€æ··å…¥ data çš„æ–¹æ³•ï¼Œè¿™ä¼šæ”¹å˜å…¨å±€ optionsï¼Œè¿™æ—¶å€™å°±éœ€è¦å¯¹æ–°å¢çš„ data æ•°æ®è¿›è¡Œå¤„ç†ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code> methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">clickMix</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            test<span class="token operator">:</span><span class="token string">'111'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> options <span class="token operator">=</span> Ctor<span class="token punctuation">.</span>options<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>Ctor<span class="token punctuation">.</span>super<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Vueæˆ–è€…VueComponent</span>
  <span class="token keyword">var</span> superOptions <span class="token operator">=</span> <span class="token function">resolveConstructorOptions</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">.</span>super<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> cachedSuperOptions <span class="token operator">=</span> Ctor<span class="token punctuation">.</span>superOptions<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>superOptions <span class="token operator">!==</span> cachedSuperOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Ctor<span class="token punctuation">.</span>superOptions <span class="token operator">=</span> superOptions<span class="token punctuation">;</span>
    <span class="token keyword">var</span> modifiedOptions <span class="token operator">=</span> <span class="token function">resolveModifiedOptions</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æ›´æ–°çš„options</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiedOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">extend</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">.</span>extendOptions<span class="token punctuation">,</span> modifiedOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    options <span class="token operator">=</span> Ctor<span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>superOptions<span class="token punctuation">,</span> Ctor<span class="token punctuation">.</span>extendOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      options<span class="token punctuation">.</span>components<span class="token punctuation">[</span>options<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Ctor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> options<span class="token punctuation">;</span>
</code></pre></div><ul><li>Ctor.super æœ¬è´¨ä¸Šå°±æ˜¯ Vue æ„é€ å™¨æˆ–è€…æŸä¸ªç»„ä»¶æ„é€ å™¨ï¼Œä¸Šè¾¹è§£é‡Šäº†<code>Vue.extend</code>çš„è¿‡ç¨‹ä¸­ä¹ŸæŠŠ Vue.extend æ–¹æ³•ä¹Ÿèµ‹äºˆç»™äº†å­æ„é€ å™¨ï¼Œæ‰€ä»¥å­æ„é€ å™¨å¯ä»¥ç»§ç»­æ„å»ºè‡ªå·±çš„å­æ„é€ å™¨ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªé“¾å¼å…³ç³»ã€‚ï¼ˆä¸Šè¾¹è¯´äº†ï¼‰</li> <li>é¦–å…ˆé€šè¿‡å¾ªç¯çš„æ–¹å¼æ— é™å‘ä¸ŠæŸ¥æ‰¾ï¼Œæ‰¾åˆ°æœ€æ ¹éƒ¨çš„ Vue.optionsï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·å¯èƒ½æ“ä½œçš„ optionsã€‚ç„¶åå’Œä¸Šæ¬¡é€šè¿‡<code>Vue.extend</code>ç”Ÿæˆçš„ç»„ä»¶æ„é€ å™¨æ—¶ä¿å­˜çš„ options è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœä¸ç­‰ï¼Œå°±ä»£è¡¨ç”¨æˆ·ä¸€å®šæ˜¯æ”¹å˜è¿‡ Vue.optionsï¼Œæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æŠŠå˜åŒ–æ›´æ–°åˆ°æ¯ä¸€çº§æ„é€ å™¨ä¸Šã€‚</li> <li>å› ä¸ºé¦–å…ˆæ˜¯é€šè¿‡å¾ªç¯é€çº§æƒ³ä¸Šå¯»æ‰¾ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯å‘ä¸‹å±‚å±‚å›æº¯ï¼Œæ›´æ–°æ¯ä¸€å±‚<code>Sub.extend</code>ç”Ÿæˆçš„æ„é€ å™¨ã€‚</li> <li>é€šè¿‡æ•´ä¸ªè¿‡ç¨‹ä¿è¯äº†æ¯ä¸€ä¸ªæ„é€ å™¨ä¸Šçš„ options éƒ½æ˜¯æœ€æ–°çš„ã€‚ä¿è¯æ··å…¥å¯¹åç»­ç»„ä»¶ä¸­çš„æ“ä½œç”Ÿæ•ˆã€‚</li> <li>resolveModifiedOptions æ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠå˜åŒ–äº†çš„å±æ€§æå–å‡ºæ¥ï¼Œæœ€ç»ˆæŠŠå˜äº†çš„å±æ€§é€šè¿‡ mergeOption åˆå¹¶åˆ°ç”¨æˆ·ä¼ å…¥çš„ options ä¸Šã€‚</li></ul> <h4 id="ç»“"><a href="#ç»“" class="header-anchor">#</a> ç»“</h4> <p>åœ¨è¿›è¡Œæ•°æ®åˆå§‹åŒ–å’Œæ³¨å†Œå“åº”å¼ä¹‹å‰ç°å°†æ•°æ®æŒ‰ç…§ä¼˜å…ˆçº§åˆå¹¶ï¼Œæœ€ç»ˆå¾—åˆ°åˆå¹¶å¯¹è±¡ï¼Œè¿™æ ·å°±å®Œç¾çš„å¤„ç†äº† options çš„å…³ç³»ã€‚åŒæ—¶ä¹Ÿå¯¹å¯èƒ½å˜åŒ–çš„ options è¿›è¡Œäº†ç²¾å‡†æ›´æ–°ã€‚æ•´ä¸ª options é“¾å¤æ‚åˆå·§å¦™ï¼Œå€¼å¾—æ·±å…¥ç†è§£å’Œå‰–æã€‚</p> <p>ã€Šå®Œã€‹</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/frontend/vue_vuex_vue-router_nuxt/vcode/1.html" class="prev">
        new vue()ä¹‹å‰éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼ˆä¸€ï¼‰
      </a></span> <span class="next"><a href="/frontend/vue_vuex_vue-router_nuxt/vcode/3.html">
        åœ¨new Vue(options)ä¸­æ˜¯å¦‚ä½•ä¸ºoptionsè¿›è¡Œåˆå§‹åŒ–ï¼ˆä¸‰ï¼‰
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8a3e4be4.js" defer></script><script src="/assets/js/2.b1c453a7.js" defer></script><script src="/assets/js/44.e18663a3.js" defer></script>
  </body>
</html>
